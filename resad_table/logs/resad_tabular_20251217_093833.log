2025-12-17 09:38:33,637 - INFO - [resad_tabular.py:56] - === ResAD Tabular Experiment Started ===
2025-12-17 09:38:33,637 - INFO - [resad_tabular.py:57] - Log file: logs\resad_tabular_20251217_093833.log
2025-12-17 09:38:33,641 - INFO - [resad_tabular.py:68] - Using device: cpu
2025-12-17 09:38:33,641 - INFO - [resad_tabular.py:69] - Experiment mode: cross_domain
2025-12-17 09:38:33,642 - INFO - [resad_tabular.py:72] - Loading datasets...
2025-12-17 09:38:33,642 - INFO - [resad_tabular.py:98] - Cross domain experiment:
2025-12-17 09:38:33,643 - INFO - [resad_tabular.py:99] -   Source datasets: ['breastw']
2025-12-17 09:38:33,644 - INFO - [resad_tabular.py:100] -   Target dataset: wdbc
2025-12-17 09:38:33,657 - INFO - [resad_tabular.py:111] - Dataset Information:
2025-12-17 09:38:33,658 - INFO - [resad_tabular.py:112] - Train (source combined): {'dataset_name': 'breastw', 'split': 'train', 'shape': (478, 9), 'anomaly_ratio': '0.349', 'normal_samples': np.int64(311), 'anomaly_samples': np.int64(167), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-17 09:38:33,658 - INFO - [resad_tabular.py:113] - Test (target): {'dataset_name': 'wdbc', 'split': 'test', 'shape': (111, 30), 'anomaly_ratio': '0.027', 'normal_samples': np.int64(108), 'anomaly_samples': np.int64(3), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-17 09:38:33,659 - INFO - [resad_tabular.py:125] - Initializing ResAD model...
2025-12-17 09:38:33,660 - INFO - [resad_tabular.py:126] - Model configuration:
2025-12-17 09:38:33,660 - INFO - [resad_tabular.py:127] -   - Use multiscale: False
2025-12-17 09:38:33,661 - INFO - [resad_tabular.py:128] -   - Constraintor type: residual
2025-12-17 09:38:33,661 - INFO - [resad_tabular.py:129] -   - Estimator type: normal
2025-12-17 09:38:33,663 - INFO - [resad_tabular.py:130] -   - Training epochs: 2
2025-12-17 09:38:33,663 - INFO - [resad_tabular.py:131] -   - Learning rate: 0.001
2025-12-17 09:38:33,668 - INFO - [resad_tabular.py:135] - Starting model training...
2025-12-17 09:38:52,666 - INFO - [resad_model.py:173] - Fitting feature extractor with 311 normal samples
2025-12-17 09:38:52,666 - INFO - [resad_model.py:96] - Fitting TabPFN feature extractor with 311 training samples
2025-12-17 09:38:52,668 - INFO - [resad_model.py:101] - Initializing constraintor and estimator modules
2025-12-17 09:38:58,364 - INFO - [resad_model.py:104] - Feature extractor fitted. Embedding dimension: 192
2025-12-17 09:38:58,365 - INFO - [resad_model.py:175] - Feature extractor fitted successfully
2025-12-17 09:38:58,365 - INFO - [resad_model.py:178] - Pre-computing embeddings for training data...
2025-12-17 09:39:17,191 - INFO - [resad_model.py:189] - Batch 0: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 09:39:17,751 - INFO - [resad_model.py:189] - Batch 1: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 09:39:18,305 - INFO - [resad_model.py:189] - Batch 2: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 09:39:18,864 - INFO - [resad_model.py:189] - Batch 3: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 09:39:19,519 - INFO - [resad_model.py:189] - Batch 4: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 09:39:20,070 - INFO - [resad_model.py:189] - Batch 5: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 09:39:20,625 - INFO - [resad_model.py:189] - Batch 6: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 09:39:21,165 - INFO - [resad_model.py:189] - Batch 7: features shape=(30, 9), embeddings shape=torch.Size([30, 192]), labels shape=(30,)
2025-12-17 09:39:21,775 - INFO - [resad_model.py:197] - Total embeddings shape: torch.Size([478, 192])
2025-12-17 09:39:21,775 - INFO - [resad_model.py:198] - Total labels shape: torch.Size([478])
2025-12-17 09:39:21,776 - INFO - [resad_model.py:199] - Total samples: embeddings=478, labels=478
2025-12-17 09:39:21,778 - INFO - [resad_model.py:205] - Normal embeddings shape for constraintor training: torch.Size([311, 192])
2025-12-17 09:39:21,778 - INFO - [resad_model.py:208] - Starting feature constraintor training...
2025-12-17 09:39:21,879 - INFO - [resad_model.py:265] - Feature constraintor training completed
2025-12-17 09:39:21,879 - INFO - [resad_model.py:268] - Starting distribution estimator fitting...
2025-12-17 09:39:21,909 - INFO - [resad_model.py:277] - Distribution estimator fitted successfully
2025-12-17 09:39:21,910 - INFO - [resad_model.py:280] - ResAD training completed successfully!
2025-12-17 09:39:21,913 - INFO - [resad_tabular.py:139] - Evaluating model on test set...
2025-12-17 09:39:21,914 - INFO - [resad_model.py:342] - Predicting anomaly scores for DataLoader batches
2025-12-17 09:39:41,248 - INFO - [resad_model.py:349] - Predicted scores for 111 total samples
2025-12-17 09:40:00,142 - INFO - [resad_tabular.py:152] - === EXPERIMENT RESULTS ===
2025-12-17 09:40:00,142 - INFO - [resad_tabular.py:153] - AUC (Area Under ROC Curve): 0.4599
2025-12-17 09:40:00,143 - INFO - [resad_tabular.py:154] - AP (Average Precision): 0.0370
2025-12-17 09:40:00,143 - INFO - [resad_tabular.py:155] - Test samples: 111
2025-12-17 09:40:00,144 - INFO - [resad_tabular.py:156] - Anomaly ratio: 0.027
2025-12-17 09:40:00,145 - INFO - [resad_tabular.py:189] - Results saved to: results\results_cross_breastw_to_wdbc_20251217_094000.json
2025-12-17 09:40:00,146 - INFO - [resad_tabular.py:190] - === EXPERIMENT COMPLETED ===
