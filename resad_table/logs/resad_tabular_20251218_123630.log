2025-12-18 12:36:30,566 - INFO - [resad_tabular.py:63] - === ResAD Tabular Experiment Started ===
2025-12-18 12:36:30,566 - INFO - [resad_tabular.py:64] - Log file: logs\resad_tabular_20251218_123630.log
2025-12-18 12:36:30,571 - INFO - [resad_tabular.py:75] - Using device: cpu
2025-12-18 12:36:30,572 - INFO - [resad_tabular.py:76] - Experiment mode: cross_domain
2025-12-18 12:36:30,573 - INFO - [resad_tabular.py:79] - Loading datasets...
2025-12-18 12:36:30,574 - INFO - [resad_tabular.py:105] - Cross domain experiment:
2025-12-18 12:36:30,574 - INFO - [resad_tabular.py:106] -   Source datasets: ['pima']
2025-12-18 12:36:30,576 - INFO - [resad_tabular.py:107] -   Target dataset: breastw
2025-12-18 12:36:30,593 - INFO - [resad_tabular.py:118] - Dataset Information:
2025-12-18 12:36:30,593 - INFO - [resad_tabular.py:119] - Train (source combined): {'dataset_name': 'pima', 'split': 'train', 'shape': (537, 8), 'anomaly_ratio': '0.348', 'normal_samples': np.int64(350), 'anomaly_samples': np.int64(187), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-18 12:36:30,594 - INFO - [resad_tabular.py:120] - Test (target): {'dataset_name': 'breastw', 'split': 'test', 'shape': (205, 9), 'anomaly_ratio': '0.351', 'normal_samples': np.int64(133), 'anomaly_samples': np.int64(72), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-18 12:36:30,595 - INFO - [resad_tabular.py:132] - Initializing ResAD model...
2025-12-18 12:36:30,595 - INFO - [resad_tabular.py:133] - Model configuration:
2025-12-18 12:36:30,596 - INFO - [resad_tabular.py:134] -   - Feature extractor: tabpfn
2025-12-18 12:36:30,596 - INFO - [resad_tabular.py:137] -   - Use multiscale: False
2025-12-18 12:36:30,597 - INFO - [resad_tabular.py:138] -   - Constraintor type: residual
2025-12-18 12:36:30,597 - INFO - [resad_tabular.py:139] -   - Estimator type: normal
2025-12-18 12:36:30,598 - INFO - [resad_tabular.py:140] -   - Training epochs: 20
2025-12-18 12:36:30,598 - INFO - [resad_tabular.py:141] -   - Learning rate: 0.001
2025-12-18 12:36:30,601 - INFO - [resad_tabular.py:145] - Starting model training...
2025-12-18 12:36:54,897 - INFO - [resad_model.py:192] - Fitting feature extractor with 350 normal samples
2025-12-18 12:36:54,897 - INFO - [resad_model.py:115] - Fitting TabPFN feature extractor with 350 training samples
2025-12-18 12:36:54,901 - INFO - [resad_model.py:120] - Initializing constraintor and estimator modules
2025-12-18 12:37:01,268 - INFO - [resad_model.py:123] - Feature extractor fitted. Embedding dimension: 192
2025-12-18 12:37:01,270 - INFO - [resad_model.py:194] - Feature extractor fitted successfully
2025-12-18 12:37:01,271 - INFO - [resad_model.py:197] - Pre-computing embeddings for training data...
2025-12-18 12:37:29,643 - INFO - [resad_model.py:208] - Batch 0: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:30,451 - INFO - [resad_model.py:208] - Batch 1: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:31,236 - INFO - [resad_model.py:208] - Batch 2: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:32,100 - INFO - [resad_model.py:208] - Batch 3: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:32,966 - INFO - [resad_model.py:208] - Batch 4: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:33,812 - INFO - [resad_model.py:208] - Batch 5: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:34,609 - INFO - [resad_model.py:208] - Batch 6: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:35,488 - INFO - [resad_model.py:208] - Batch 7: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:37:36,418 - INFO - [resad_model.py:208] - Batch 8: features shape=(25, 8), embeddings shape=torch.Size([25, 192]), labels shape=(25,)
2025-12-18 12:37:37,125 - INFO - [resad_model.py:216] - Total embeddings shape: torch.Size([537, 192])
2025-12-18 12:37:37,125 - INFO - [resad_model.py:217] - Total labels shape: torch.Size([537])
2025-12-18 12:37:37,126 - INFO - [resad_model.py:218] - Total samples: embeddings=537, labels=537
2025-12-18 12:37:37,126 - INFO - [resad_model.py:224] - Normal embeddings shape for constraintor training: torch.Size([350, 192])
2025-12-18 12:37:37,127 - INFO - [resad_model.py:227] - Starting feature constraintor training...
2025-12-18 12:37:37,692 - INFO - [resad_model.py:282] - Epoch 10: Average Loss = 0.025563
2025-12-18 12:37:38,263 - INFO - [resad_model.py:282] - Epoch 20: Average Loss = 0.020480
2025-12-18 12:37:38,264 - INFO - [resad_model.py:284] - Feature constraintor training completed
2025-12-18 12:37:38,266 - INFO - [resad_model.py:287] - Starting distribution estimator fitting...
2025-12-18 12:37:38,275 - INFO - [resad_model.py:296] - Distribution estimator fitted successfully
2025-12-18 12:37:38,275 - INFO - [resad_model.py:299] - ResAD training completed successfully!
2025-12-18 12:37:38,278 - INFO - [resad_tabular.py:149] - Evaluating model on test set...
2025-12-18 12:37:38,279 - INFO - [resad_model.py:361] - Predicting anomaly scores for DataLoader batches
2025-12-18 12:38:03,707 - INFO - [resad_model.py:368] - Predicted scores for 205 total samples
2025-12-18 12:38:29,166 - INFO - [resad_tabular.py:167] - === EXPERIMENT RESULTS ===
2025-12-18 12:38:29,167 - INFO - [resad_tabular.py:168] - AUC (Area Under ROC Curve): 0.7676
2025-12-18 12:38:29,168 - INFO - [resad_tabular.py:169] - AP (Average Precision): 0.7410
2025-12-18 12:38:29,169 - INFO - [resad_tabular.py:170] - Accuracy: 0.6976
2025-12-18 12:38:29,170 - INFO - [resad_tabular.py:171] - Test samples: 205
2025-12-18 12:38:29,171 - INFO - [resad_tabular.py:172] - Anomaly ratio: 0.351
2025-12-18 12:38:29,195 - INFO - [resad_tabular.py:250] - Results saved to: results\results_cross_pima_to_breastw_20251218_123829.json
2025-12-18 12:38:29,197 - INFO - [resad_tabular.py:251] - Summary saved to: results\results.csv
2025-12-18 12:38:29,197 - INFO - [resad_tabular.py:252] - === EXPERIMENT COMPLETED ===
