2025-12-18 12:43:58,257 - INFO - [resad_tabular.py:63] - === ResAD Tabular Experiment Started ===
2025-12-18 12:43:58,258 - INFO - [resad_tabular.py:64] - Log file: logs\resad_tabular_20251218_124358.log
2025-12-18 12:43:58,261 - INFO - [resad_tabular.py:75] - Using device: cuda
2025-12-18 12:43:58,261 - INFO - [resad_tabular.py:76] - Experiment mode: cross_domain
2025-12-18 12:43:58,261 - INFO - [resad_tabular.py:79] - Loading datasets...
2025-12-18 12:43:58,262 - INFO - [resad_tabular.py:105] - Cross domain experiment:
2025-12-18 12:43:58,262 - INFO - [resad_tabular.py:106] -   Source datasets: ['breastw']
2025-12-18 12:43:58,262 - INFO - [resad_tabular.py:107] -   Target dataset: wdbc
2025-12-18 12:43:58,274 - INFO - [resad_tabular.py:118] - Dataset Information:
2025-12-18 12:43:58,274 - INFO - [resad_tabular.py:119] - Train (source combined): {'dataset_name': 'breastw', 'split': 'train', 'shape': (478, 9), 'anomaly_ratio': '0.349', 'normal_samples': np.int64(311), 'anomaly_samples': np.int64(167), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-18 12:43:58,275 - INFO - [resad_tabular.py:120] - Test (target): {'dataset_name': 'wdbc', 'split': 'test', 'shape': (111, 30), 'anomaly_ratio': '0.027', 'normal_samples': np.int64(108), 'anomaly_samples': np.int64(3), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-18 12:43:58,275 - INFO - [resad_tabular.py:132] - Initializing ResAD model...
2025-12-18 12:43:58,276 - INFO - [resad_tabular.py:133] - Model configuration:
2025-12-18 12:43:58,276 - INFO - [resad_tabular.py:134] -   - Feature extractor: tabpfn
2025-12-18 12:43:58,277 - INFO - [resad_tabular.py:137] -   - Use multiscale: False
2025-12-18 12:43:58,277 - INFO - [resad_tabular.py:138] -   - Constraintor type: residual
2025-12-18 12:43:58,277 - INFO - [resad_tabular.py:139] -   - Estimator type: normal
2025-12-18 12:43:58,278 - INFO - [resad_tabular.py:140] -   - Training epochs: 100
2025-12-18 12:43:58,278 - INFO - [resad_tabular.py:141] -   - Learning rate: 0.001
2025-12-18 12:43:58,281 - INFO - [resad_tabular.py:145] - Starting model training...
2025-12-18 12:44:26,893 - INFO - [resad_model.py:192] - Fitting feature extractor with 311 normal samples
2025-12-18 12:44:26,894 - INFO - [resad_model.py:115] - Fitting TabPFN feature extractor with 311 training samples
2025-12-18 12:44:26,896 - INFO - [resad_model.py:120] - Initializing constraintor and estimator modules
2025-12-18 12:44:32,420 - INFO - [resad_model.py:123] - Feature extractor fitted. Embedding dimension: 192
2025-12-18 12:44:32,421 - INFO - [resad_model.py:194] - Feature extractor fitted successfully
2025-12-18 12:44:32,422 - INFO - [resad_model.py:197] - Pre-computing embeddings for training data...
2025-12-18 12:44:58,994 - INFO - [resad_model.py:208] - Batch 0: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:44:59,361 - INFO - [resad_model.py:208] - Batch 1: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:44:59,761 - INFO - [resad_model.py:208] - Batch 2: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:45:00,031 - INFO - [resad_model.py:208] - Batch 3: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:45:00,297 - INFO - [resad_model.py:208] - Batch 4: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:45:00,566 - INFO - [resad_model.py:208] - Batch 5: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:45:00,835 - INFO - [resad_model.py:208] - Batch 6: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-18 12:45:01,098 - INFO - [resad_model.py:208] - Batch 7: features shape=(30, 9), embeddings shape=torch.Size([30, 192]), labels shape=(30,)
2025-12-18 12:45:02,026 - INFO - [resad_model.py:216] - Total embeddings shape: torch.Size([478, 192])
2025-12-18 12:45:02,027 - INFO - [resad_model.py:217] - Total labels shape: torch.Size([478])
2025-12-18 12:45:02,027 - INFO - [resad_model.py:218] - Total samples: embeddings=478, labels=478
2025-12-18 12:45:02,034 - INFO - [resad_model.py:224] - Normal embeddings shape for constraintor training: torch.Size([311, 192])
2025-12-18 12:45:02,035 - INFO - [resad_model.py:227] - Starting feature constraintor training...
2025-12-18 12:45:02,793 - INFO - [resad_model.py:282] - Epoch 10: Average Loss = 0.027583
2025-12-18 12:45:03,249 - INFO - [resad_model.py:282] - Epoch 20: Average Loss = 0.021746
2025-12-18 12:45:03,696 - INFO - [resad_model.py:282] - Epoch 30: Average Loss = 0.019583
2025-12-18 12:45:04,143 - INFO - [resad_model.py:282] - Epoch 40: Average Loss = 0.018361
2025-12-18 12:45:04,596 - INFO - [resad_model.py:282] - Epoch 50: Average Loss = 0.017242
2025-12-18 12:45:05,041 - INFO - [resad_model.py:282] - Epoch 60: Average Loss = 0.016392
2025-12-18 12:45:05,490 - INFO - [resad_model.py:282] - Epoch 70: Average Loss = 0.015578
2025-12-18 12:45:05,960 - INFO - [resad_model.py:282] - Epoch 80: Average Loss = 0.014793
2025-12-18 12:45:06,414 - INFO - [resad_model.py:282] - Epoch 90: Average Loss = 0.014325
2025-12-18 12:45:06,858 - INFO - [resad_model.py:282] - Epoch 100: Average Loss = 0.013768
2025-12-18 12:45:06,859 - INFO - [resad_model.py:284] - Feature constraintor training completed
2025-12-18 12:45:06,859 - INFO - [resad_model.py:287] - Starting distribution estimator fitting...
