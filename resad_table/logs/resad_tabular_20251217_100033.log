2025-12-17 10:00:33,903 - INFO - [resad_tabular.py:63] - === ResAD Tabular Experiment Started ===
2025-12-17 10:00:33,903 - INFO - [resad_tabular.py:64] - Log file: logs\resad_tabular_20251217_100033.log
2025-12-17 10:00:33,905 - INFO - [resad_tabular.py:75] - Using device: cpu
2025-12-17 10:00:33,905 - INFO - [resad_tabular.py:76] - Experiment mode: single_domain
2025-12-17 10:00:33,905 - INFO - [resad_tabular.py:79] - Loading datasets...
2025-12-17 10:00:33,905 - INFO - [resad_tabular.py:84] - Single domain experiment on dataset: breastw
2025-12-17 10:00:33,913 - INFO - [resad_tabular.py:94] - Dataset Information:
2025-12-17 10:00:33,915 - INFO - [resad_tabular.py:95] - Train: {'dataset_name': 'breastw', 'split': 'train', 'shape': (478, 9), 'anomaly_ratio': '0.349', 'normal_samples': np.int64(311), 'anomaly_samples': np.int64(167), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-17 10:00:33,915 - INFO - [resad_tabular.py:96] - Test: {'dataset_name': 'breastw', 'split': 'test', 'shape': (205, 9), 'anomaly_ratio': '0.351', 'normal_samples': np.int64(133), 'anomaly_samples': np.int64(72), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-17 10:00:33,915 - INFO - [resad_tabular.py:132] - Initializing ResAD model...
2025-12-17 10:00:33,915 - INFO - [resad_tabular.py:133] - Model configuration:
2025-12-17 10:00:33,915 - INFO - [resad_tabular.py:134] -   - Use multiscale: False
2025-12-17 10:00:33,915 - INFO - [resad_tabular.py:135] -   - Constraintor type: residual
2025-12-17 10:00:33,915 - INFO - [resad_tabular.py:136] -   - Estimator type: normal
2025-12-17 10:00:33,916 - INFO - [resad_tabular.py:137] -   - Training epochs: 1
2025-12-17 10:00:33,916 - INFO - [resad_tabular.py:138] -   - Learning rate: 0.001
2025-12-17 10:00:33,920 - INFO - [resad_tabular.py:142] - Starting model training...
2025-12-17 10:00:55,363 - INFO - [resad_model.py:176] - Fitting feature extractor with 311 normal samples
2025-12-17 10:00:55,363 - INFO - [resad_model.py:99] - Fitting TabPFN feature extractor with 311 training samples
2025-12-17 10:00:55,364 - INFO - [resad_model.py:104] - Initializing constraintor and estimator modules
2025-12-17 10:01:00,986 - INFO - [resad_model.py:107] - Feature extractor fitted. Embedding dimension: 192
2025-12-17 10:01:00,986 - INFO - [resad_model.py:178] - Feature extractor fitted successfully
2025-12-17 10:01:00,986 - INFO - [resad_model.py:181] - Pre-computing embeddings for training data...
2025-12-17 10:01:22,233 - INFO - [resad_model.py:192] - Batch 0: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 10:01:22,831 - INFO - [resad_model.py:192] - Batch 1: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 10:01:23,624 - INFO - [resad_model.py:192] - Batch 2: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 10:01:24,219 - INFO - [resad_model.py:192] - Batch 3: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 10:01:24,893 - INFO - [resad_model.py:192] - Batch 4: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 10:01:25,513 - INFO - [resad_model.py:192] - Batch 5: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 10:01:26,150 - INFO - [resad_model.py:192] - Batch 6: features shape=(64, 9), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-17 10:01:26,767 - INFO - [resad_model.py:192] - Batch 7: features shape=(30, 9), embeddings shape=torch.Size([30, 192]), labels shape=(30,)
2025-12-17 10:01:27,687 - INFO - [resad_model.py:200] - Total embeddings shape: torch.Size([478, 192])
2025-12-17 10:01:27,687 - INFO - [resad_model.py:201] - Total labels shape: torch.Size([478])
2025-12-17 10:01:27,687 - INFO - [resad_model.py:202] - Total samples: embeddings=478, labels=478
2025-12-17 10:01:27,687 - INFO - [resad_model.py:208] - Normal embeddings shape for constraintor training: torch.Size([311, 192])
2025-12-17 10:01:27,688 - INFO - [resad_model.py:211] - Starting feature constraintor training...
2025-12-17 10:01:27,735 - INFO - [resad_model.py:268] - Feature constraintor training completed
2025-12-17 10:01:27,735 - INFO - [resad_model.py:271] - Starting distribution estimator fitting...
2025-12-17 10:01:27,739 - INFO - [resad_model.py:280] - Distribution estimator fitted successfully
2025-12-17 10:01:27,739 - INFO - [resad_model.py:283] - ResAD training completed successfully!
2025-12-17 10:01:27,739 - INFO - [resad_tabular.py:146] - Evaluating model on test set...
2025-12-17 10:01:27,739 - INFO - [resad_model.py:345] - Predicting anomaly scores for DataLoader batches
2025-12-17 10:01:51,693 - INFO - [resad_model.py:352] - Predicted scores for 205 total samples
2025-12-17 10:02:13,393 - INFO - [resad_tabular.py:164] - === EXPERIMENT RESULTS ===
2025-12-17 10:02:13,394 - INFO - [resad_tabular.py:165] - AUC (Area Under ROC Curve): 0.9920
2025-12-17 10:02:13,394 - INFO - [resad_tabular.py:166] - AP (Average Precision): 0.9845
2025-12-17 10:02:13,394 - INFO - [resad_tabular.py:167] - Accuracy: 0.8537
2025-12-17 10:02:13,394 - INFO - [resad_tabular.py:168] - Test samples: 205
2025-12-17 10:02:13,394 - INFO - [resad_tabular.py:169] - Anomaly ratio: 0.351
2025-12-17 10:02:13,403 - INFO - [resad_tabular.py:245] - Results saved to: results\results_breastw_single_domain_20251217_100213.json
2025-12-17 10:02:13,403 - INFO - [resad_tabular.py:246] - Summary saved to: results\results.csv
2025-12-17 10:02:13,403 - INFO - [resad_tabular.py:247] - === EXPERIMENT COMPLETED ===
