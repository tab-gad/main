2025-12-16 21:06:05,620 - INFO - [resad_tabular.py:58] - === ResAD Tabular Experiment Started ===
2025-12-16 21:06:05,620 - INFO - [resad_tabular.py:59] - Log file: logs\resad_tabular_20251216_210605.log
2025-12-16 21:06:05,624 - INFO - [resad_tabular.py:410] - Using device: cpu
2025-12-16 21:06:05,624 - INFO - [resad_tabular.py:411] - Experiment mode: cross_domain
2025-12-16 21:06:05,625 - INFO - [resad_tabular.py:414] - Loading datasets...
2025-12-16 21:06:05,625 - INFO - [resad_tabular.py:440] - Cross domain experiment:
2025-12-16 21:06:05,626 - INFO - [resad_tabular.py:441] -   Source datasets: ['pima']
2025-12-16 21:06:05,627 - INFO - [resad_tabular.py:442] -   Target dataset: breastw
2025-12-16 21:06:05,637 - INFO - [resad_tabular.py:453] - Dataset Information:
2025-12-16 21:06:05,638 - INFO - [resad_tabular.py:454] - Train (source combined): {'dataset_name': 'pima', 'split': 'train', 'shape': (537, 8), 'anomaly_ratio': '0.348', 'normal_samples': np.int64(350), 'anomaly_samples': np.int64(187), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-16 21:06:05,640 - INFO - [resad_tabular.py:455] - Test (target): {'dataset_name': 'breastw', 'split': 'test', 'shape': (205, 9), 'anomaly_ratio': '0.351', 'normal_samples': np.int64(133), 'anomaly_samples': np.int64(72), 'feature_names': ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', '...'], 'normalized': True, 'categorical_features': 0}
2025-12-16 21:06:05,641 - INFO - [resad_tabular.py:467] - Initializing ResAD model...
2025-12-16 21:06:05,642 - INFO - [resad_tabular.py:468] - Model configuration:
2025-12-16 21:06:05,642 - INFO - [resad_tabular.py:469] -   - Use multiscale: False
2025-12-16 21:06:05,643 - INFO - [resad_tabular.py:470] -   - Constraintor type: residual
2025-12-16 21:06:05,643 - INFO - [resad_tabular.py:471] -   - Estimator type: normal
2025-12-16 21:06:05,643 - INFO - [resad_tabular.py:472] -   - Training epochs: 2
2025-12-16 21:06:05,644 - INFO - [resad_tabular.py:473] -   - Learning rate: 0.001
2025-12-16 21:06:05,648 - INFO - [resad_tabular.py:477] - Starting model training...
2025-12-16 21:06:24,460 - INFO - [resad_tabular.py:223] - Fitting feature extractor with 350 normal samples
2025-12-16 21:06:24,461 - INFO - [resad_tabular.py:146] - Fitting TabPFN feature extractor with 350 training samples
2025-12-16 21:06:24,464 - INFO - [resad_tabular.py:151] - Initializing constraintor and estimator modules
2025-12-16 21:06:32,260 - INFO - [resad_tabular.py:154] - Feature extractor fitted. Embedding dimension: 192
2025-12-16 21:06:32,261 - INFO - [resad_tabular.py:225] - Feature extractor fitted successfully
2025-12-16 21:06:32,263 - INFO - [resad_tabular.py:228] - Pre-computing embeddings for training data...
2025-12-16 21:06:52,417 - INFO - [resad_tabular.py:239] - Batch 0: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:53,010 - INFO - [resad_tabular.py:239] - Batch 1: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:53,584 - INFO - [resad_tabular.py:239] - Batch 2: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:54,251 - INFO - [resad_tabular.py:239] - Batch 3: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:54,814 - INFO - [resad_tabular.py:239] - Batch 4: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:55,371 - INFO - [resad_tabular.py:239] - Batch 5: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:55,931 - INFO - [resad_tabular.py:239] - Batch 6: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:56,486 - INFO - [resad_tabular.py:239] - Batch 7: features shape=(64, 8), embeddings shape=torch.Size([64, 192]), labels shape=(64,)
2025-12-16 21:06:57,026 - INFO - [resad_tabular.py:239] - Batch 8: features shape=(25, 8), embeddings shape=torch.Size([25, 192]), labels shape=(25,)
2025-12-16 21:06:57,641 - INFO - [resad_tabular.py:247] - Total embeddings shape: torch.Size([537, 192])
2025-12-16 21:06:57,641 - INFO - [resad_tabular.py:248] - Total labels shape: torch.Size([537])
2025-12-16 21:06:57,642 - INFO - [resad_tabular.py:249] - Total samples: embeddings=537, labels=537
2025-12-16 21:06:57,643 - INFO - [resad_tabular.py:255] - Normal embeddings shape for constraintor training: torch.Size([350, 192])
2025-12-16 21:06:57,643 - INFO - [resad_tabular.py:258] - Starting feature constraintor training...
2025-12-16 21:06:57,766 - INFO - [resad_tabular.py:315] - Feature constraintor training completed
2025-12-16 21:06:57,766 - INFO - [resad_tabular.py:318] - Starting distribution estimator fitting...
2025-12-16 21:06:57,775 - INFO - [resad_tabular.py:327] - Distribution estimator fitted successfully
2025-12-16 21:06:57,775 - INFO - [resad_tabular.py:330] - ResAD training completed successfully!
2025-12-16 21:06:57,777 - INFO - [resad_tabular.py:481] - Evaluating model on test set...
2025-12-16 21:06:57,778 - INFO - [resad_tabular.py:392] - Predicting anomaly scores for DataLoader batches
2025-12-16 21:07:17,456 - INFO - [resad_tabular.py:399] - Predicted scores for 205 total samples
2025-12-16 21:07:36,609 - INFO - [resad_tabular.py:494] - === EXPERIMENT RESULTS ===
2025-12-16 21:07:36,610 - INFO - [resad_tabular.py:495] - AUC (Area Under ROC Curve): 0.8287
2025-12-16 21:07:36,611 - INFO - [resad_tabular.py:496] - AP (Average Precision): 0.7974
2025-12-16 21:07:36,612 - INFO - [resad_tabular.py:497] - Test samples: 205
2025-12-16 21:07:36,613 - INFO - [resad_tabular.py:498] - Anomaly ratio: 0.351
2025-12-16 21:07:36,615 - INFO - [resad_tabular.py:531] - Results saved to: results\results_cross_pima_to_breastw_20251216_210736.json
2025-12-16 21:07:36,615 - INFO - [resad_tabular.py:532] - === EXPERIMENT COMPLETED ===
